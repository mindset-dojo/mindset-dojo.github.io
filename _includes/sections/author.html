{%- comment -%}
author card within section

Expects:
  - include.author â†’ profile object
Notes:
  - Still uses site.data.program.levels to render the level icon color/label.
  - Still uses icons from /_includes/icons/*.svg (same paths as before).
This file now guards the markup with `if include.author` so it won't error
if called without an author object.
{%- endcomment -%}

<section class="md-author-card">
  {% assign author_slug = include.author.slug | to_s | strip | slugify %}
  {% assign author_name = include.author.name | default: "Author" %}
  {% assign profile_url = '/authors/' | append: author_slug | append: '/' | relative_url %}
  {% assign avatar_path = '/media/author-avatar/' | append: author_slug | append: '.jpg' | relative_url %}

  <img
    src="{{ avatar_path }}"
    alt="{{ author_name }}"
    width="100"
    height="100"
  />

  <h2><a href="{{ profile_url }}">{{ author_name }}</a></h2>

  {%- if include.author.emoji_signature -%}
    <h3 class="author-card-emoji-signature"> {{ include.author.emoji_signature }} </h3>
  {%- endif -%}

  {%- assign ld = include.author.leadership_designations -%}
  {%- if ld -%}
    {%- assign lines = "" | split: "" -%}
    {%- for item in ld -%}
      {%- assign v = item.value | to_s | strip -%}
      {%- if v != "" and v != "null" -%}
        {%- assign lines = lines | push: v -%}
      {%- endif -%}
    {%- endfor -%}
    {%- if lines.size > 0 -%}
      <p>{{ lines | join: "<br>" }}</p>
    {%- endif -%}
  {%- endif -%}

  {%- if include.author.program_level -%}
    <div class="md-group">
      {%- if include.author.program_level -%}
        {% assign program_level = include.author.program_level | plus: 0 %}
        {% assign level = site.data.sections.program.sections | where: "type", "levels" | map: "data" | map: "items" | first | where: "level", program_level | first %}
        {% include icons/level.svg
          class="md-level-svg"
          color=level.color
          title=level.label %}
      {%- endif -%}
    </div>
  {%- endif -%}
</section>
